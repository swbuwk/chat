{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/DENI/Desktop/\\u043A\\u043E\\u0434/vsCode/authJWT/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\DENI\\\\Desktop\\\\\\u043A\\u043E\\u0434\\\\vsCode\\\\authJWT\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import AuthService from\"../services/AuthService\";import{setUserData,eraseUserData}from\"./userSlice\";import axios from\"axios\";import{API_URL}from\"../http\";export var login=function login(email,password){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var res,accessToken;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return AuthService.login(email,password);case 3:res=_context.sent;accessToken=res.data.accessToken;localStorage.setItem(\"token\",accessToken);dispatch(setUserData(res.data));_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var registration=function registration(name,email,password){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var res,accessToken;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return AuthService.registration(name,email,password);case 3:res=_context2.sent;accessToken=res.data.accessToken;localStorage.setItem(\"token\",accessToken);dispatch(setUserData(res.data));_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[0,9]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var checkAuth=function checkAuth(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var res,accessToken;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.get(\"\".concat(API_URL,\"/refresh\"),{withCredentials:true});case 3:res=_context3.sent;accessToken=res.data.accessToken;localStorage.setItem(\"token\",accessToken);dispatch(setUserData(res.data));_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 12:case\"end\":return _context3.stop();}}},_callee3,null,[[0,9]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var logout=function logout(){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return AuthService.logout();case 3:res=_context4.sent;localStorage.removeItem(\"token\");dispatch(eraseUserData());_context4.next=11;break;case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](0);console.log(_context4.t0);case 11:case\"end\":return _context4.stop();}}},_callee4,null,[[0,8]]);}));return function(_x4){return _ref4.apply(this,arguments);};}();};","map":{"version":3,"names":["AuthService","setUserData","eraseUserData","axios","API_URL","login","email","password","dispatch","res","accessToken","data","localStorage","setItem","console","log","registration","name","checkAuth","get","withCredentials","logout","removeItem"],"sources":["C:/Users/DENI/Desktop/код/vsCode/authJWT/client/src/store/actionCreator.js"],"sourcesContent":["import AuthService from \"../services/AuthService\"\r\nimport { setUserData, eraseUserData } from \"./userSlice\"\r\nimport axios from \"axios\"\r\nimport { API_URL } from \"../http\"\r\n\r\nexport const login = (email, password) => async (dispatch) => {\r\n    try {\r\n        const res = await AuthService.login(email, password)\r\n        const accessToken = res.data.accessToken\r\n        localStorage.setItem(\"token\", accessToken)\r\n        dispatch(setUserData(res.data))\r\n    } catch(e) {\r\n        console.log(e)\r\n    }\r\n}\r\n\r\nexport const registration = (name, email, password) => async (dispatch) => {\r\n    try {\r\n        const res = await AuthService.registration(name, email, password)\r\n        const accessToken = res.data.accessToken\r\n        localStorage.setItem(\"token\", accessToken)\r\n        dispatch(setUserData(res.data))\r\n    } catch(e) {\r\n        console.log(e)\r\n    }\r\n}\r\n\r\nexport const checkAuth = () => async (dispatch) => {\r\n      try {\r\n          const res = await axios.get(`${API_URL}/refresh`, {withCredentials: true})\r\n          const accessToken = res.data.accessToken\r\n          localStorage.setItem(\"token\", accessToken)\r\n          dispatch(setUserData(res.data))\r\n      } catch(e) {\r\n          console.log(e)\r\n      }\r\n}\r\n\r\nexport const logout = () => async (dispatch) => {\r\n    try {\r\n        const res = await AuthService.logout()\r\n        localStorage.removeItem(\"token\")\r\n        dispatch(eraseUserData())\r\n    } catch(e) {\r\n        console.log(e)\r\n    }\r\n}"],"mappings":"uTAAA,MAAOA,CAAAA,WAAP,KAAwB,yBAAxB,CACA,OAASC,WAAT,CAAsBC,aAAtB,KAA2C,aAA3C,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,OAAT,KAAwB,SAAxB,CAEA,MAAO,IAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACC,KAAD,CAAQC,QAAR,iGAAqB,iBAAOC,QAAP,4KAEhBR,CAAAA,WAAW,CAACK,KAAZ,CAAkBC,KAAlB,CAAyBC,QAAzB,CAFgB,QAE5BE,GAF4B,eAG5BC,WAH4B,CAGdD,GAAG,CAACE,IAAJ,CAASD,WAHK,CAIlCE,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8BH,WAA9B,EACAF,QAAQ,CAACP,WAAW,CAACQ,GAAG,CAACE,IAAL,CAAZ,CAAR,CALkC,+EAOlCG,OAAO,CAACC,GAAR,cAPkC,oEAArB,gEAAd,CAWP,MAAO,IAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,IAAD,CAAOX,KAAP,CAAcC,QAAd,kGAA2B,kBAAOC,QAAP,kLAE7BR,CAAAA,WAAW,CAACgB,YAAZ,CAAyBC,IAAzB,CAA+BX,KAA/B,CAAsCC,QAAtC,CAF6B,QAEzCE,GAFyC,gBAGzCC,WAHyC,CAG3BD,GAAG,CAACE,IAAJ,CAASD,WAHkB,CAI/CE,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8BH,WAA9B,EACAF,QAAQ,CAACP,WAAW,CAACQ,GAAG,CAACE,IAAL,CAAZ,CAAR,CAL+C,mFAO/CG,OAAO,CAACC,GAAR,eAP+C,sEAA3B,kEAArB,CAWP,MAAO,IAAMG,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,mGAAM,kBAAOV,QAAP,kLAEHL,CAAAA,KAAK,CAACgB,GAAN,WAAaf,OAAb,aAAgC,CAACgB,eAAe,CAAE,IAAlB,CAAhC,CAFG,QAEfX,GAFe,gBAGfC,WAHe,CAGDD,GAAG,CAACE,IAAJ,CAASD,WAHR,CAIrBE,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8BH,WAA9B,EACAF,QAAQ,CAACP,WAAW,CAACQ,GAAG,CAACE,IAAL,CAAZ,CAAR,CALqB,mFAOrBG,OAAO,CAACC,GAAR,eAPqB,sEAAN,kEAAlB,CAWP,MAAO,IAAMM,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,mGAAM,kBAAOb,QAAP,sKAEFR,CAAAA,WAAW,CAACqB,MAAZ,EAFE,QAEdZ,GAFc,gBAGpBG,YAAY,CAACU,UAAb,CAAwB,OAAxB,EACAd,QAAQ,CAACN,aAAa,EAAd,CAAR,CAJoB,mFAMpBY,OAAO,CAACC,GAAR,eANoB,sEAAN,kEAAf"},"metadata":{},"sourceType":"module"}